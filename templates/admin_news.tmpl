{{template "_header.tmpl" .}}
        <script src="https://cdn.jsdelivr.net/npm/tinymce@7/tinymce.min.js"></script>
        <script>
                tinymce.init({
                        selector: '#content',
                        plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount checklist mediaembed casechange export formatpainter pagebreak permanentpen table advtable tinycomments mentions quickbars linkchecker help',
                        toolbar: 'undo redo | formatselect | bold italic underline strikethrough | forecolor backcolor permanentpen | link image media pagebreak | align | numlist bullist | checklist emoticons charmap | indent outdent | removeformat | code help',
                        skin: 'oxide-dark',
                        content_css: 'dark',
                        height: 400,
                        branding: false,
                        relative_urls: false,
                        convert_urls: false,
                        body_class: 'tinymce-dark',
                        content_style: 'body { font-family: Roboto, sans-serif; font-size: 14px; color: #e8e8e8; background-color: #2a2a2a; }'
                });

                function submitNewsForm(form) {
                        tinymce.triggerSave();
                        const title = form.querySelector('input[name="title"]').value.trim();
                        const content = tinymce.get('content').getContent().trim();
                        
                        if (!title) {
                                alert('Title is required');
                                return false;
                        }
                        if (!content) {
                                alert('Content is required');
                                return false;
                        }
                        
                        return true;
                }
        </script>
        <div class="content-card">
                <div class="content-header">
                        <i class="fas fa-newspaper"></i>
                        <div class="content-header-text">
                                <span>Admin News</span>
                        </div>
                </div>
                <div class="content-body">
                        <!-- CREATE NEWS FORM -->
                        <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(0,0,0,.2); border-radius: 8px; border: 1px solid var(--border-color);">
                                <h3 style="color: var(--accent-gold); margin-bottom: 1rem; font-family: 'Cinzel', serif;">{{if .EditingNews}}Edit News{{else}}Create News{{end}}</h3>
                                <form method="POST" action="{{if .EditingNews}}/admin/news/update/{{.EditingNews.ID}}{{else}}/admin/news/create{{end}}" style="display: flex; flex-direction: column; gap: 1rem;" onsubmit="return submitNewsForm(this);">
                                        <div>
                                                <label for="title" style="color: var(--accent-gold); font-weight: 600; display: block; margin-bottom: 0.5rem;">Title</label>
                                                <input type="text" id="title" name="title" value="{{if .EditingNews}}{{.EditingNews.Title}}{{end}}" style="width: 100%; padding: 0.75rem; background: rgba(0,0,0,.3); border: 1px solid var(--border-color); color: var(--text-light); border-radius: 4px; font-family: 'Roboto', sans-serif;" placeholder="News title">
                                        </div>
                                        <div>
                                                <label for="content" style="color: var(--accent-gold); font-weight: 600; display: block; margin-bottom: 0.5rem;">Content</label>
                                                <textarea id="content" name="content" style="width: 100%; min-height: 200px;">{{if .EditingNews}}{{.EditingNews.Content}}{{end}}</textarea>
                                        </div>
                                        <div style="display: flex; gap: 0.75rem;">
                                                <button type="submit" style="background: linear-gradient(180deg, #e6c98a 0%, #c9a86a 45%, #a8834f 100%); color: #1a1410; padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-family: 'Cinzel', serif;">{{if .EditingNews}}Update News{{else}}Create News{{end}}</button>
                                                {{if .EditingNews}}<a href="/admin/news" style="background: rgba(100,100,100,.3); color: var(--text-light); padding: 0.75rem 1.5rem; border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none; font-weight: 600; font-family: 'Cinzel', serif; display: inline-block;">Cancel</a>{{end}}
                                        </div>
                                </form>
                        </div>

                        <!-- NEWS LIST -->
                        <h3 style="color: var(--accent-gold); margin-bottom: 1rem; margin-top: 2rem; font-family: 'Cinzel', serif;">News Articles{{if gt .TotalNews 3}} (Total: {{.TotalNews}}){{end}}</h3>
                        {{if .NewsList}}
                                {{range .NewsList}}
                                <div style="margin-bottom: 1rem; padding: 1.5rem; background: rgba(0,0,0,.2); border-radius: 8px; border: 1px solid var(--border-color);">
                                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                                                <div>
                                                        <h4 style="color: var(--accent-gold); margin: 0 0 0.5rem 0; font-family: 'Cinzel', serif;">{{.Title}}</h4>
                                                        <p style="color: var(--text-muted); font-size: 0.85rem; margin: 0 0 0.75rem 0;">{{.CreatedAt.Format "January 2, 2006 15:04"}}</p>
                                                        <div style="color: var(--text-light); margin: 0; line-height: 1.6;">{{HTML .Content}}</div>
                                                </div>
                                                <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
                                                        <a href="/admin/news/edit/{{.ID}}?page={{$.CurrentPage}}" style="background: linear-gradient(180deg, #e6c98a 0%, #c9a86a 45%, #a8834f 100%); color: #1a1410; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; text-decoration: none; font-family: 'Cinzel', serif; font-size: 0.9rem;">Edit</a>
                                                        <form method="POST" action="/admin/news/delete/{{.ID}}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this news?');">
                                                                <button type="submit" style="background: #8B4545; color: #fff; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-family: 'Cinzel', serif; font-size: 0.9rem;">Delete</button>
                                                        </form>
                                                </div>
                                        </div>
                                </div>
                                {{end}}

                                <!-- PAGINATION CONTROLS - Only show if more than 3 articles -->
                                {{if gt .TotalNews 3}}
                                <div style="display: flex; gap: 0.5rem; justify-content: center; margin-top: 2rem; align-items: center; flex-wrap: wrap;">
                                        {{range $page := until .TotalPages}}
                                                {{if eq (add $page 1) $.CurrentPage}}
                                                        <span style="background: linear-gradient(180deg, #e6c98a 0%, #c9a86a 45%, #a8834f 100%); color: #1a1410; padding: 0.5rem 0.75rem; border: none; border-radius: 4px; font-weight: 700; font-family: 'Cinzel', serif; font-size: 0.9rem; min-width: 2.5rem; text-align: center;">{{add $page 1}}</span>
                                                {{else}}
                                                        <a href="/admin/news?page={{add $page 1}}" style="background: rgba(169,152,102,0.2); color: var(--accent-gold); padding: 0.5rem 0.75rem; border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none; font-weight: 600; font-family: 'Cinzel', serif; font-size: 0.9rem; min-width: 2.5rem; text-align: center; transition: all 0.2s;">{{add $page 1}}</a>
                                                {{end}}
                                        {{end}}
                                </div>
                                {{end}}
                        {{else}}
                                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">No news articles yet.</p>
                        {{end}}
                </div>
        </div>
{{template "_footer.tmpl" .}}
